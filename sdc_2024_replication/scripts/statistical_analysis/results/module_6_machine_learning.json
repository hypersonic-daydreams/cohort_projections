{
  "module": "6",
  "analysis": "machine_learning_elastic_net_rf_clustering",
  "generated": "2026-01-02T17:26:07.475875+00:00",
  "input_files": [
    "module_3_1_panel_data.parquet",
    "census.state_components (PostgreSQL)",
    "module_1_1_summary_statistics.json",
    "module_1_1_trend_decomposition.json"
  ],
  "parameters": {
    "panel_observations": 765,
    "n_states": 51,
    "years_covered": [
      2010,
      2011,
      2012,
      2013,
      2014,
      2015,
      2016,
      2017,
      2018,
      2019,
      2020,
      2021,
      2022,
      2023,
      2024
    ],
    "models": {
      "elastic_net": {
        "cv_folds": 5,
        "l1_ratios_tested": [
          0.1,
          0.3,
          0.5,
          0.7,
          0.9,
          0.95,
          0.99
        ],
        "alpha_range": "logspace(-6, 1, 50)"
      },
      "random_forest": {
        "n_estimators": 500,
        "max_depth": 10,
        "permutation_repeats": 30
      },
      "clustering": {
        "methods": [
          "K-Means",
          "Hierarchical (Ward)"
        ],
        "k_range": "2-10",
        "optimization_criterion": "Silhouette score"
      }
    }
  },
  "results": {
    "elastic_net": {
      "optimal_alpha": 0.0007196856730011514,
      "optimal_l1_ratio": 0.9,
      "r_squared": 0.6189146139503882,
      "cv_r2": 0.5993192668640515,
      "top_features": [
        "log_population",
        "natural_change",
        "birth_rate"
      ],
      "n_nonzero_coefficients": 3
    },
    "random_forest": {
      "oob_score": 0.9532698950435113,
      "cv_r2": 0.9447728486626612,
      "top_features_by_importance": [
        "log_population",
        "death_rate",
        "dom_mig_rate"
      ]
    },
    "clustering": {
      "optimal_k": 2,
      "silhouette_score": 0.4779778097709744,
      "calinski_harabasz": 17.56735013000971,
      "davies_bouldin": 0.9489837437202685,
      "cluster_sizes": {
        "0": 4,
        "1": 47
      },
      "nd_cluster": 1,
      "nd_peer_states": [
        "Alabama",
        "Alaska",
        "Arizona",
        "Arkansas",
        "Colorado",
        "Connecticut",
        "Delaware",
        "District of Columbia",
        "Georgia",
        "Hawaii",
        "Idaho",
        "Illinois",
        "Indiana",
        "Iowa",
        "Kansas",
        "Kentucky",
        "Louisiana",
        "Maine",
        "Maryland",
        "Massachusetts",
        "Michigan",
        "Minnesota",
        "Mississippi",
        "Missouri",
        "Montana",
        "Nebraska",
        "Nevada",
        "New Hampshire",
        "New Jersey",
        "New Mexico",
        "North Carolina",
        "Ohio",
        "Oklahoma",
        "Oregon",
        "Pennsylvania",
        "Rhode Island",
        "South Carolina",
        "South Dakota",
        "Tennessee",
        "Utah",
        "Vermont",
        "Virginia",
        "Washington",
        "West Virginia",
        "Wisconsin",
        "Wyoming"
      ]
    }
  },
  "diagnostics": {
    "elastic_net": {
      "cv_scores": [
        0.7162335408780818,
        0.5804257043152299,
        0.48507944637640965,
        0.43636746055982945,
        0.7784901821907065
      ],
      "sparsity": 0.4
    },
    "random_forest": {
      "n_estimators": 500,
      "max_depth": 10
    },
    "clustering": {
      "pca_variance_explained": 0.6467626976744968,
      "optimal_k_by_method": {
        "silhouette": 2,
        "calinski_harabasz": 3,
        "davies_bouldin": 10,
        "elbow": 6
      }
    }
  },
  "warnings": [],
  "decisions": [
    {
      "decision_id": "D001",
      "timestamp": "2026-01-02T17:25:42.684953+00:00",
      "category": "feature_engineering",
      "decision": "Created 30+ state-level aggregated features from panel data",
      "rationale": "Aggregating across years captures stable state characteristics for clustering",
      "alternatives_considered": [
        "Use year-specific features",
        "Time-weighted aggregation"
      ],
      "evidence": "Generated 36 features for 51 states",
      "reversible": true
    },
    {
      "decision_id": "D002",
      "timestamp": "2026-01-02T17:25:42.779027+00:00",
      "category": "model_selection",
      "decision": "Selected Elastic Net with alpha=0.0007, l1_ratio=0.90",
      "rationale": "ElasticNetCV performs 5-fold cross-validation across alpha and l1_ratio grid",
      "alternatives_considered": [
        "Pure Lasso (l1_ratio=1)",
        "Ridge (l1_ratio=0)",
        "Manual tuning"
      ],
      "evidence": "CV R2 = 0.5993 (+/- 0.2619)",
      "reversible": true
    },
    {
      "decision_id": "D003",
      "timestamp": "2026-01-02T17:26:03.809920+00:00",
      "category": "model_selection",
      "decision": "Used Random Forest with 500 trees, max_depth=10 for feature importance",
      "rationale": "RF provides non-linear importance measures; permutation importance is more reliable than impurity-based",
      "alternatives_considered": [
        "Gradient Boosting",
        "XGBoost",
        "SHAP values"
      ],
      "evidence": "OOB Score = 0.9533, CV R2 = 0.9448",
      "reversible": true
    },
    {
      "decision_id": "D004",
      "timestamp": "2026-01-02T17:26:04.002579+00:00",
      "category": "clustering",
      "decision": "Selected K=2 clusters based on silhouette score",
      "rationale": "Silhouette score balances cluster cohesion and separation",
      "alternatives_considered": [
        "Elbow method suggests K=6",
        "Calinski-Harabasz suggests K=3"
      ],
      "evidence": "Silhouette score at K=2: 0.4780",
      "reversible": true
    }
  ],
  "next_steps": [
    "Use cluster membership for stratified analysis in Module 7",
    "Compare ND with peer states identified in same cluster",
    "Apply feature importance insights to projection model refinement",
    "Consider ensemble of Elastic Net and RF for prediction"
  ]
}
